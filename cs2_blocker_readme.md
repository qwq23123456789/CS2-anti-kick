# CS2 Steam Blocker v3.4

## 📋 簡介

CS2 Steam Blocker 是一個專為 Counter-Strike 2 設計的工具程式，能夠在比賽進行時自動阻止 Steam 的特定網路連線（UDP 端口 3478-3480），防止被踢出伺服器或其他網路干擾問題。

## ✨ 主要功能

- 🎮 **自動偵測遊戲狀態** - 透過 GSI (Game State Integration) 即時監控比賽狀態
- 🔒 **智能防火牆管理** - 比賽開始時自動阻止 Steam UDP 連線，結束後自動恢復
- ⌨️ **全域快捷鍵控制** - 使用小鍵盤快速切換阻止/恢復功能
- 🖥️ **系統托盤整合** - 常駐系統托盤，顏色指示當前狀態
- 🔔 **聲音與通知提醒** - 重要操作時播放提示音並顯示通知
- ⚙️ **手動/自動模式** - 可選擇自動運作或手動控制

## 🎯 使用場景

適用於遇到以下問題的 CS2 玩家：
- 比賽中經常被踢出伺服器
- 遭遇惡意投票踢人
- 網路連線不穩定導致斷線

## 📦 系統需求

- **作業系統**: Windows 10/11
- **權限**: 需要管理員權限（用於修改防火牆規則）
- **遊戲**: Counter-Strike 2
- **Python**: 3.8+ (如使用原始碼執行)

## 🚀 快速開始

### 方法 1: 使用編譯版本 (推薦)

1. 下載 `CS2SteamBlocker.exe`
2. **以管理員身分執行**程式
3. 程式會自動創建 GSI 配置檔
4. 啟動 CS2，開始遊戲即可自動運作

### 方法 2: 從原始碼執行

1. 安裝 Python 3.8+
2. 安裝依賴套件：
   ```bash
   pip install keyboard pystray pillow pywin32
   ```
3. 以管理員身分執行：
   ```bash
   python cs2-steam-blocker-python.py
   ```

## ⌨️ 快捷鍵說明

所有快捷鍵使用**小鍵盤**（NumPad）：

| 快捷鍵 | 功能 |
|--------|------|
| 小鍵盤 0 | 🔔 測試快捷鍵（確認功能正常） |
| 小鍵盤 1 | 🚫 手動阻止 Steam 連線 |
| 小鍵盤 2 | ✅ 手動恢復 Steam 連線 |
| 小鍵盤 3 | ⚙️ 切換自動模式開關 |

> 💡 **提示**: 首次使用建議先按小鍵盤 0 測試快捷鍵是否正常運作

## 🎨 托盤圖示狀態

程式運行時會在系統托盤顯示圖示，顏色代表不同狀態：

- 🟢 **綠色** - 正常狀態，未在比賽中
- 🟠 **橘色** - 比賽進行中，Steam 連線正常
- 🔴 **紅色** - Steam 連線已阻止（防護啟動）

右鍵點擊托盤圖示可開啟選單進行更多操作。

## 📁 GSI 配置檔

程式會自動嘗試在以下位置創建 GSI 配置檔：
```
C:\Program Files (x86)\Steam\steamapps\common\Counter-Strike Global Offensive\game\csgo\cfg\
```

如果自動創建失敗，會在程式目錄下生成 `gamestate_integration_cs2steamblock.cfg`，需手動複製到上述 CS2 cfg 資料夾。

## ⚙️ 運作原理

1. **GSI 監控** - 透過 CS2 的 Game State Integration 即時獲取遊戲狀態
2. **狀態判斷** - 偵測到進入比賽（live/warmup 階段）時觸發
3. **防火牆規則** - 使用 Windows 防火牆阻止 Steam.exe 的 UDP 3478-3480 端口
4. **自動恢復** - 比賽結束後自動移除防火牆規則，恢復正常連線

## 🔧 進階功能

### 托盤選單功能

- **測試功能** - 測試快捷鍵、檢查防火牆規則
- **手動控制** - 隨時手動阻止/恢復 Steam 連線
- **自動模式切換** - 啟用/停用自動阻止功能
- **重新創建 GSI** - 重新生成 GSI 配置檔
- **退出程式** - 安全退出（會自動恢復被阻止的連線）

## ⚠️ 注意事項

1. **必須以管理員身分執行** - 需要權限修改防火牆規則
2. **僅限單人/非競技模式使用** - 避免影響正常競技遊戲
3. **防火牆規則** - 程式會自動管理，退出時會清理
4. **端口 3000** - GSI 伺服器使用 127.0.0.1:3000，確保端口未被占用
5. **備份重要設定** - 首次使用建議備份防火牆設定

## 🛠️ 常見問題

### Q: 程式無法啟動？
A: 確認是否以管理員身分執行，並檢查是否安裝所有依賴套件。

### Q: 快捷鍵沒有反應？
A: 按小鍵盤 0 測試，如果沒反應表示快捷鍵註冊失敗，需要管理員權限。

### Q: GSI 配置檔創建失敗？
A: 手動從程式目錄複製 `gamestate_integration_cs2steamblock.cfg` 到 CS2 的 cfg 資料夾。

### Q: Steam 連線被阻止後無法恢復？
A: 使用小鍵盤 2 手動恢復，或重啟程式（退出時會自動清理規則）。

### Q: 會影響其他 Steam 遊戲嗎？
A: 只在 CS2 比賽進行時阻止特定端口，退出比賽後自動恢復，不影響其他遊戲。

## 📝 編譯說明

使用 PyInstaller 編譯為執行檔：

```bash
pyinstaller --clean --onefile --name=CS2SteamBlocker --uac-admin --hidden-import=keyboard --hidden-import=pystray --hidden-import=PIL C:\path\to\cs2-steam-blocker-python.py
```

## 🔐 安全性

- 程式完全在本機運行，不會連接外部伺服器
- 僅修改 Windows 防火牆規則，不修改系統核心設定
- 開源透明，可自行檢視原始碼
- 退出時會自動清理所有防火牆規則

## 📄 授權

本專案僅供個人學習使用，使用者需自行承擔使用風險。

## 🤝 支援

如有問題或建議，歡迎回報！

---

**免責聲明**: 本工具僅供研究和個人使用，請勿用於任何可能違反遊戲服務條款的行為。使用本工具造成的任何後果由使用者自行承擔。